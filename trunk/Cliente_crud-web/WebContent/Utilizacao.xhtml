<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">
	
	<!-- métodos rodados ao carregar página -->
	<f:event listener="#{utilizacaoBean.listarUtilizacaoEspera}" type="preRenderView" />
	<f:event listener="#{utilizacaoBean.listarUtilizacaoAndamento}" type="preRenderView" />
	<f:event listener="#{utilizacaoBean.listarVideogameDisponivel}" type="preRenderView" />
<h:head>
	<style>
.posicao_botao {
	width: 51%;
}

.botao {
	margin-top: 5px;
	margin-left: 5px;
}

.tableConsulta tr:nth-child(even) {
	background-color: #cacaca;
}

.tableConsulta {
	border: 1px solid #cacaca;
	border-collapse: collapse;
	border-spacing: 0;
}
</style>

	<style>
.ui-layout-north {
	z-index: 20 !important;
	overflow: visible !important;
}

.ui-layout-north .ui-layout-unit-content {
	overflow: visible !important;
}
</style>
</h:head>
<body bgcolor="#E8E8E8">
	<!-- global confirm -->
	<p:confirmDialog global="true" showEffect="fade">
		<p:commandButton value="Sim" type="button"
			styleClass="ui-confirmdialog-yes" />
		<p:commandButton value="Não" type="button"
			styleClass="ui-confirmdialog-no" />
	</p:confirmDialog>

	<!-- Includes -->
	<!-- Cliente -->
	<p:dialog id="dialog_cliente" header="Clientes"
		widgetVar="modalCliente" modal="true" width="100%" height="500"
		position="bottom">
		<ui:include src="/Cliente/Cliente.xhtml"></ui:include>
	</p:dialog>

	<!-- Evento -->
	<p:dialog id="dialog_evento" header="Eventos" widgetVar="modalEvento"
		modal="true" width="100%" height="500" position="bottom">
		<ui:include src="/Evento/Evento.xhtml"></ui:include>
	</p:dialog>

	<!-- Jogo -->
	<p:dialog id="dialog_jogo" header="Jogos" widgetVar="modalJogo"
		modal="true" width="100%" height="500" position="bottom">
		<ui:include src="/Jogo/Jogo.xhtml"></ui:include>
	</p:dialog>

	<!-- Plataforma -->
	<p:dialog id="dialog_plataforma" header="Plataformas"
		widgetVar="modalPlataforma" modal="true" width="100%" height="500"
		position="bottom">
		<ui:include src="/Plataforma/Plataforma.xhtml"></ui:include>
	</p:dialog>

	<!-- Usuario -->
	<p:dialog id="dialog_usuario" header="Usuários"
		widgetVar="modalUsuario" modal="true" width="100%" height="500"
		position="bottom">
		<ui:include src="/Usuario/Usuario.xhtml"></ui:include>
	</p:dialog>

	<!-- Videogame -->
	<p:dialog id="dialog_videogame" header="Videogames"
		widgetVar="modalVideogame" modal="true" width="100%" height="500"
		position="bottom">
		<ui:include src="/Videogame/Videogame.xhtml"></ui:include>
	</p:dialog>

	<h:form id="form_3">
		<p:growl id="messages" />



		<p:dialog id="dialogIncluirUtilizacao"
			widgetVar="dialogIncluirUtilizacao" modal="true">
			<table border="0">
				<tr>
					<td><b>Nome:</b></td>
					<td><h:outputText value="#{utilizacaoBean.cliente.nome}" /></td>
				</tr>
				<tr>
					<td><b>Login:</b></td>
					<td><h:outputText value="#{utilizacaoBean.cliente.login}" />
					</td>
				</tr>
			</table>
			<hr />
			<table border="0">
				<tr>
					<td><b>Plataforma:</b></td>
					<td><p:selectOneMenu value="#{utilizacaoBean.plataforma.id}">
							<f:selectItem itemLabel="Selecione" itemValue="" />
							<f:selectItems value="#{utilizacaoBean.listaPlataforma}"
								var="plataforma" itemLabel="#{plataforma.nome}"
								itemValue="#{plataforma.id}" />
							<p:ajax listener="#{utilizacaoBean.listarJogo}"
								update="comboJogo" />
						</p:selectOneMenu></td>
				</tr>
				<tr>
					<td><b>Jogo:</b></td>
					<td><p:selectOneMenu id="comboJogo" widgetVar="comboJogo"
							value="#{jogoBean.plataforma.id}">
							<f:selectItem itemLabel="Selecione" itemValue="" />
							<f:selectItems value="#{utilizacaoBean.listaJogo}" var="jogo"
								itemLabel="#{jogo.titulo}" itemValue="#{jogo.id}" />
						</p:selectOneMenu></td>
				</tr>
			</table>
			<br />

			<table border="0">
				<tr>
					<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
					<td><p:panel id="painel_2">
							<table border="0">
								<tr>
									<td><b>Tempo:</b></td>
									<td>
											<p:inputMask value="#{utilizacaoBean.utilizacao.qtdTempoSolicitado}" 
											mask="99:99" converter="tempoConverter" style="width:50px;"/>
											</td>
								</tr>
								<tr>
									<td><b>Valor: R$</b></td>
									<td><p:inputText style="width:50px;" /></td>
								</tr>
							</table>
						</p:panel><br /> <p:commandButton value="Cancelar" /> <p:commandButton
							value="Continuar" action="#{utilizacaoBean.continuarInclusao}"
							update="dialogIncluirUtilizacao, dataListEspera" /></td>
				</tr>
			</table>
		</p:dialog>














		<p:layout fullPage="true">

			<p:layoutUnit position="north" size="100">
				<!-- <div style="font-size:40px;">Play Games</div>
		<div>Sistema Gerenciador</div><br /> -->
				<p:menubar>
					<p:menuitem value="Utilização" />
					<p:submenu label="Cadastros">
						<p:menuitem value="Cliente" action="#{clienteBean.listarCliente}"
							update=":panelGroupCliente"
							oncomplete="PF('modalCliente').show();" />
						<p:menuitem value="Evento" action="#{eventoBean.listarEvento}"
							update=":formListarEvento" oncomplete="PF('modalEvento').show();" />
						<p:menuitem value="Jogo" action="#{jogoBean.listarJogo}"
							update=":panelGroupJogo" oncomplete="PF('modalJogo').show();" />
						<p:menuitem value="Plataforma"
							action="#{plataformaBean.listarPlataforma}"
							update=":formListarPlataforma"
							oncomplete="PF('modalPlataforma').show();" />
						<p:menuitem value="Usuário" action="#{usuarioBean.listarUsuario}"
							update=":panelGroupUsuario"
							oncomplete="PF('modalUsuario').show();" />
						<p:menuitem value="Videogame"
							action="#{videogameBean.listarVideogame}"
							update=":panelGroupVideogame"
							oncomplete="PF('modalVideogame').show();" />
					</p:submenu>
					<p:menuitem value="Relatórios" />
				</p:menubar>
			</p:layoutUnit>
			<!--  -->

			<p:layoutUnit position="west"  header="Utilizações" size="800">
			<!-- <p:panelGrid style="margin-top:20px">
					<f:facet name="header">
						<p:row>
							<p:column>Código</p:column>
							<p:column>Videogame</p:column>
							<p:column>Login</p:column>
							<p:column>Tempo</p:column>
							<p:column></p:column>
							<p:column></p:column>
						</p:row>

					</f:facet>

					<p:row>
						<p:column style="font-weight: bold;">445</p:column>
						<p:column style="font-weight: bold;">Playstation 4</p:column>
						<p:column style="font-weight: bold;">Pedro</p:column>
						<p:column style="font-weight: bold;">
						
							<pe:timer  
						    widgetVar="timer"  
						    timeout="10000"  
						    format="HH:mm:ss" /> 
						
						</p:column>
						<p:column style="font-weight: bold;">
							<p:commandButton value="vizualizar" style="position:center" />
						</p:column>
						<p:column style="font-weight: bold;">
							<p:commandButton value="Pausar" style="position:center" onclick="PF('timer').pause()" type="button" />
						</p:column>
					</p:row>
				</p:panelGrid> -->

				
				
				
				
		<p:dataTable id="dataTableUtilizacao" 
			widgetVar="dataTableUtilizacao" 
			value="#{utilizacaoBean.listaUtilizacaoAndamento}" 
			var="utilizacao">

				<p:column>
					<f:facet name="header">
						<h:outputText value="Código" />
					</f:facet>
					<h:outputText value="#{utilizacao.videogame.id}" />
				</p:column>
				<p:column>
					<f:facet name="header">
						<h:outputText value="Videogame" />
					</f:facet>
					<h:outputText value="#{utilizacao.videogame.plataforma.nome}" />
				</p:column>
				<p:column>
					<f:facet name="header">
						<h:outputText value="Login" />
					</f:facet>
					<h:outputText value="#{utilizacao.cliente.login}" />
				</p:column>
				<p:column>
					<f:facet name="header">
						<h:outputText value="Tempo" />
					</f:facet>
					<pe:timer widgetVar="timer" timeout="#{utilizacao.qtdTempoSolicitado}" format="HH:mm:ss" />
				</p:column>
				<p:column>
					<p:commandButton value="vizualizar" style="position:center" />
				</p:column>
				<p:column>
					<p:commandButton value="Pausar" style="position:center" onclick="PF('timer').pause()" type="button" />
				</p:column>
			</p:dataTable>
				
				
				
				
			</p:layoutUnit>

			<p:layoutUnit position="east" size="330">
				<p:panel id="incluirUtilizacao" header="Incluir Utilização"
					style="margin-bottom:20px">
					<h:outputLabel value="CPF: " />
					<p:inputText value="#{utilizacaoBean.cliente.cpf}" />
					<br />
					<br />
					<div align="right">
						<p:commandButton value="Enviar"
							action="#{utilizacaoBean.incluirUtilizacao}"
							update="dialogIncluirUtilizacao"
							oncomplete="PF('dialogIncluirUtilizacao').show();" />
					</div>
				</p:panel>


				<p:dataList id="dataListEspera" widgetVar="dataListEspera"
					value="#{utilizacaoBean.listaUtilizacaoEspera}" var="utilizacao"
					type="definition">
					<f:facet name="header">
			            Espera
			        </f:facet>
			        <p:panel header="Login: #{utilizacao.cliente.login}" closeSpeed="0" style="padding: 0px; margin: 10px; ">
			        	<p:commandButton style=" height:30px; font-size: 70%;" value="Iniciar" 
			        	action="#{utilizacaoBean.iniciarUtilizacao}" 
			        	update=":form_3:dataTableUtilizacao, :form_3:dataListEspera, :form_3:dataTableVideogame">
			        		<f:setPropertyActionListener target="#{utilizacaoBean.utilizacao}"
							value="#{utilizacao}"/>
			        	</p:commandButton>
			        	<p:commandButton style="height:30px; font-size: 70%;"  value="Visualizar" />
			        	<p:commandButton style=" height:30px; font-size: 70%;"  value="Cancelar" />
			        </p:panel>
			    </p:dataList>

			</p:layoutUnit>

			<p:layoutUnit position="center" header="Videogames">
				
				<p:dataTable id="dataTableVideogame" widgetVar="dataTableVideogame"
				 value="#{utilizacaoBean.listaVideogameDisponiveis}" var="videogame">
	
					<p:column>
						<f:facet name="header">
							<h:outputText value="Código" />
						</f:facet>
						<h:outputText value="#{videogame.id}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="Videogame" />
						</f:facet>
						<h:outputText value="#{videogame.plataforma.nome}" />
					</p:column>
				</p:dataTable>

			</p:layoutUnit>

		</p:layout>




	</h:form>

</body>
</html>
