<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"> 

<h:head></h:head> 
<body> 

<h:form id="formListar">	
		
	<p:panel id="pnl" widgetVar="painelListar" visible="true" closable="true" closeSpeed="0">
		<p:commandButton  value="Cadastrar" action="#{usuarioBean.limparUsuario}" onclick="painelListar.close(); painelCadastrar.show();" update=":formListar" />
		<p:commandButton value="Listar" action="#{usuarioBean.listarUsuario}" update="tableUsu" />
		
		<p:dataTable value="#{usuarioBean.usuarios}" var="usu" emptyMessage="" id="tableUsu" >
			
				<p:column>
					<f:facet name="header"><h:outputText value="Nome" /></f:facet>
					<h:outputText value="#{usu.nome}" />
				</p:column>
				<p:column>          
					<f:facet name="header"><h:outputText value="Senha" /></f:facet>
					<h:outputText value="#{usu.senha}" />
				</p:column>
				<p:column>
					<h:inputHidden value="#{usu.idusuario}" />
					<p:commandButton value="Alterar" action="#{usuarioBean.obterUsuario}" onclick="painelListar.close(); painelAlterar.show();" update=":formAlterar:gridAlterar">
						<f:setPropertyActionListener target="#{usuarioBean.usuario}" value="#{usu}"></f:setPropertyActionListener>
					</p:commandButton>
					<p:commandButton value="Excluir" action="#{usuarioBean.obterUsuario}" onclick="confirmation.show()" >
						<f:setPropertyActionListener target="#{usuarioBean.usuario}" value="#{usu}"></f:setPropertyActionListener>
					</p:commandButton>
				</p:column>		
		</p:dataTable>
	</p:panel>

	<p:panel widgetVar="painelCadastrar" visible="false" closable="true" closeSpeed="0">
		<p:commandButton  value="Voltar" onclick="painelCadastrar.close(); painelListar.show();" type="button" />		
			<p:panelGrid columns="2">
				
				<f:facet name="header">
					<h:outputLabel value="Cadastro Usuário " />
				</f:facet>
				
				<h:outputLabel for="nome" value="Nome: " />  
	    		<p:inputText id="nome" value="#{usuarioBean.usuario.nome}" label="Nome"/>
	    		
	    		<h:outputLabel for="login" value="Login: " />  
	    		<p:inputText id="login" value="#{usuarioBean.usuario.login}" label="Login" />
	    		
	    		<h:outputLabel for="senha" value="Senha: " />  
	    		<p:inputText id="senha" value="#{usuarioBean.usuario.senha}" label="Senha" />
	    		
	    		<h:outputLabel for="permissao" value="Permissão: " />  
	    		<h:selectOneMenu value="#{usuarioBean.usuario.permissao}"  id="permissao">
	    			<f:selectItem itemLabel="Atendente" itemValue="Atendente"/>
	    			<f:selectItem itemLabel="Gerente" itemValue="Gerente"/>
	    		</h:selectOneMenu>
				
				<f:facet name="footer">  
			        <p:commandButton value="Enviar" action="#{usuarioBean.incluirUsuario}" style="position:center"
			        oncomplete="painelCadastrar.close(); painelListar.show();" update="tableUsu"/>  
			    </f:facet> 
				
			</p:panelGrid>		
	</p:panel>

</h:form>

<h:form id="formAlterar">
		<p:panel id="painelAlterar" widgetVar="painelAlterar" visible="false" closable="true" closeSpeed="0">
		<p:commandButton  value="Voltar" onclick="painelAlterar.close(); painelListar.show();" type="button" />		
			<p:panelGrid id="gridAlterar" columns="2" >
				
				<f:facet name="header">
					<h:outputLabel value="Aterar Usuário " />
				</f:facet>
				
				<h:outputLabel for="nome" value="Nome: " />  
	    		<p:inputText id="nome2" value="#{usuarioBean.usuario.nome}" label="Nome"/>
	    		
	    		<h:outputLabel for="login" value="Login: " />  
	    		<p:inputText id="login2" value="#{usuarioBean.usuario.login}" label="Login" />
	    		
	    		<h:outputLabel for="senha" value="Senha: " />  
	    		<p:inputText id="senha2" value="#{usuarioBean.usuario.senha}" label="Senha" />
	    		
	    		<h:outputLabel for="permissao" value="Permissão: " />  
	    		<h:selectOneMenu value="#{usuarioBean.usuario.permissao}"  id="permissao2">
	    			<f:selectItem itemLabel="Atendente" itemValue="Atendente"/>
	    			<f:selectItem itemLabel="Gerente" itemValue="Gerente"/>
	    		</h:selectOneMenu>
				
				<f:facet name="footer">  
			        <p:commandButton value="Enviar" action="#{usuarioBean.atualizarUsuario}" style="position:center"
			        onclick="painelAlterar.close(); painelListar.show();" update=":formListar:tableUsu" />  
			    </f:facet> 
				
			</p:panelGrid>		
	</p:panel>

</h:form>

<h:form id="formModal">
	<p:growl id="messages" />

	<p:confirmDialog  message="Tem certeza que deseja efetuar esta exclusão ?" header="Confirmation" severity="alert" widgetVar="confirmation" hideEffect="explode" >
		<p:commandButton value="Sim" update="messages, :formListar:tableUsu" oncomplete="confirmation.hide()" actionListener="#{usuarioBean.excluirUsuario}" />
		<p:commandButton value="Não" onclick="confirmation.hide()" type="button" />
	</p:confirmDialog>	
</h:form>	

<h:form id="formUpload" enctype="multipart/form-data">

    <p:fileUpload fileUploadListener="#{arquivoBean.uploadArquivo}" mode="advanced" dragDropSupport="true"
                update="messages"/>

    <p:growl id="messages" showDetail="true"/>
</h:form>
	
</body> 
</html>
